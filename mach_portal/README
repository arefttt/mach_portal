تفاوت ها با جیلبریک yalu-mach_portal عرضه شده توسط لوکا:
۱- افست های دستگاه ها به شکل کامل اضافه شده
۲ - بهسازی کد نویسی
۳- پکیج های مورد نیاز برای سیستم عامل بصورت فولدر قرار داده شده (لوکا بصورت یک فایل tar قرار داده)
۴- رفع مشکل پرمیژن های فایل ها

افزودن پشتیبانی از سایر دستگاه ها
فایل فریمور دستگاه را آنزیپ کنید و فایل kernelcache را از آن استخراج کنید :
سپس آن را به کمک دستور زیر hexdump کنید
$ hexdump -C kernelcache.release.n51 | head

نتیحجه بایستی مشابه با این متن باشد!
00000000  30 83 b5 9b 0d 16 04 49  4d 34 50 16 04 6b 72 6e  |0......IM4P..krn|
00000010  6c 16 1c 4b 65 72 6e 65  6c 43 61 63 68 65 42 75  |l..KernelCacheBu|
00000020  69 6c 64 65 72 2d 31 31  36 32 2e 32 30 2e 31 04  |ilder-1162.20.1.|
00000030  83 b5 9a de 63 6f 6d 70  6c 7a 73 73 83 13 7d ae  |....complzss..}.|
00000040  01 64 80 00 00 b5 29 5e  00 00 00 01 00 00 00 00  |.d....)^........|
00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
*
000001b0  00 00 00 00 ff cf fa ed  fe 0c 00 00 01 d5 00 f6  |................|
000001c0  f0 02 f6 f0 14 f6 f0 38  0e 9a f3 f1 20 f6 f1 00  |.......8.... ...|
000001d0  19 ff f1 f5 f0 5f 9f 5f  54 45 58 54 09 02 1c 03  |....._._TEXT....|

به افست ff cf fa ed fe بروید ( 0x1b4 )

از گیت هاب من و یا هر جای دیگر lzssdec را دانلود کنید !

دستور زیر را وارد کنید
lzssdec -o 0x1b4 < kernel.release.n51 > kernel.decompressed

فایل خروجی را در آخرین نسخه IDA باز کنید

زمانی که درخواست split by kext را داد بر روی yes کلیک کنید

 حدود سی دقیقه صبر کنید!!!

به مسیر زیر بروید
open subviews -> segments
 سگمنت
__TEXT:HEADER

 باید با هگز FFFFFFF007004000 شروع شود

به
view -> open subviews -> names بروید
و
kernproc data symbol
را بیابید
مقدار
__TEXT:HEADER
را از آن کم کنید و هگز به دست آمده افست  kernproc شماست

به مسیر
view -> open subviews -> strings
و خط زیر را پیدا کنید
"pgrp_add : pgrp is dead adding process"

دکمه ایکس رو روی کیبورد بزنید
و از بین دوفانکشن موجود ، فانکشن کوتاه تر را انتخاب کنید و در IDA graph view باز کنید


این مقدار pgrp_add شما در XNU می باشد

به پایین CFG اسکرول کنید و مقادیری مشابه با مقادیر زیر میبینید
    ADRP  X8, #qword_FFFFFFF0075A8128@PAGE
    LDR   X9, [X8,#qword_FFFFFFF0075A8128@PAGEOFF]
این آدرس all_proc شماست و از آن مقدار kern_proc را کم کنید و هگز آن را در فایل اضافه کنید!

فایل offset.c را باز نموده و پشتیبانی از دستگاه خود  را اضافه کنید! ( فقط نیاز است که مقادیر kernproc و allproc را تغییر دهید)

